%% 限制换道次数=1
% 20% AV
d_2 = [3,5,10,20,29,37,41,45,53,59,63,69,78,90,100,115];
q_2 = [252,502,1006,1848,1806,1687,1597,1555,1429,1330,1261,1156,998,775,581,299];
s_2 = [100.66, 100.35, 100.53, 93.16, 63.39, 46.04, 38.58, 35.27, 26.97, 22.56, 20.30, 16.77, 12.91, 8.68, 5.81, 2.60];

d_a_2 = [3,5,10,20,29,37,45,54,61,69,77,87,101,114,124,126];
q_a_2 = [254,494,1007,1856,1780,1681,1532,1422,1299,1179,1025,839,578,321,144,115];
s_a_2 = [101.25, 99.48, 100.65, 93.41, 61.69, 45.54, 33.86, 26.57, 21.22, 17.19, 13.29, 9.68, 5.76, 2.82, 1.17, 0.94];

%% 不限制换道次数
% 20% AV,ORIGINAL
N_d_2 = [5, 10, 18, 20, 20.82, 24, 27.56, 29.22, 36.5, 43.91, 52.53, 60.13, 68.37, 76.66, 88, 101.96, 113.79, 121.89];
N_q_2 = [505,1008,1792,1926.57,1926.86,1891,1863,1819,1710,1604,1461,1343,1188,1055,826,564,338,183];
N_s_2 = [100.88, 100.80, 99.54, 96.57, 92.57, 78.8, 67.63, 62.3, 46.91, 36.59, 27.89, 22.41, 17.45, 13.84, 9.43, 5.54, 2.97, 1.51];

% NEW
N_d_a_2 = [10, 19.95, 28.26, 35.74, 42.75, 52.19, 68.89, 76.41, 88.14, 118.79];
N_q_a_2 = [1007,1906,1836,1758,1638,1479,1180,1061,838,243];
N_s_a_2 = [100.66, 95.56, 65.01, 49.28, 38.4, 28.42, 17.19, 13.96, 9.55, 2.05];

% 40% AV
% original
N_d_4 = [5, 10, 20, 21.68, 22.43, 23.79, 25, 27.53, 33, 38.45, 40.59, 41, 46.08, 51.72, 58.13, 60.86, 64.83, 75.57, 89.01, 95.62, 108.97, 121.33];
N_q_4 = [508,1011,1966,2031,1849,1978,1880,1937,1855,1758,1717,1692,1651,1576,1469,1389,1343,1062,818,687,418,180];
N_s_4 = [101.56, 101.05, 98.37,93.71, 82.47, 83.17, 75.17, 70.44, 56.41, 46.02, 42.59, 41.51, 35.99, 30.79, 25.51,23.06,20.99, 14.42, 9.39, 7.31, 3.85, 1.52];

% NEW
N_d_a_4 = [5.01, 10, 19.93, 26.69, 33.53, 40.27, 45.69, 54.22, 60.3, 68.35, 76.85];
N_q_a_4 = [508,1010,1961,1905,1810,1720,1540,1383,1343,1159,1032];
N_s_a_4 = [101.51,101.02, 98.45, 71.43, 54.22, 43.05, 33.96, 25.7, 22.51, 17.24, 13.63];
%% q-k图
% lane1+lane2
subplot(2,1,1)
plot(N_d_4, N_q_4, '-or','MarkerSize',4,'MarkerFaceColor','r','LineWidth',1.4); hold on;  
plot(N_d_a_4, N_q_a_4 ,'-pk','MarkerSize',4,'MarkerFaceColor','k','LineWidth',1.4); hold on;  

xlabel('Density (veh/km)','FontSize',12)
ylabel('Flow (veh/h)','FontSize',12)  

set (gcf,'Position',[0,0,200,400])  %gcf:返回当前Figure对象的句柄值,设置图像大小和位置
                     %gcf,position后四个数：[pos(1) pos(2)]为绘图区域左下点的坐标 pos(3):长 pos(4):宽 
ylim([0 2100])
xlim([0,140])
legend('从零学起','基于已有经验学起')
%% q-v图
subplot(2,1,2)
plot(N_d_2, N_s_2, '-or','MarkerSize',4,'MarkerFaceColor','r','LineWidth',1.4); hold on;  
plot(N_d_a_2, N_s_a_2 ,'-pk','MarkerSize',4,'MarkerFaceColor','k','LineWidth',1.4); hold on;  

xlabel('Density (veh/km)','FontSize',12)
ylabel('Speed (km/h)','FontSize',12)  

set (gcf,'Position',[0,0,800,1000])  %gcf:返回当前Figure对象的句柄值,设置图像大小和位置
                     %gcf,position后四个数：[pos(1) pos(2)]为绘图区域左下点的坐标 pos(3):长 pos(4):宽 

xlim([0,140])
legend('从零学起','基于已有经验学起')
%legend('p_a_v=0','p_a_v=1')
