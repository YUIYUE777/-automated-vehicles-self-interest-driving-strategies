%% 限制HV换道
%% Avg
i = [25,50,100,200,300,400,500,600,700,800,900,1000,1100,1200];
% 0% AV
d_0 = [1,3,5,10,20,30,40,50,60,70,80,90,100,110,120,128,129];
q_0 = [101,252,504,1004,1734,1675,1549,1401,1252,1099,942,789,627,446,264,106,92];
s_0 = [101.06, 100.99, 100.68, 100.44, 86.68, 55.82, 38.72, 28.02, 20.87, 15.70, 11.77, 8.77, 6.26, 4.06, 2.20, 0.83, 0.73];

% 20% AV
d_2 = [1,3,5,10,20,29,30,37,38.5,39.4,40.5,41.4,45,53,59,63,69,78,90,100,115,123];
q_2 = [102,252,502,1006,1848,1806,1807,1687,1693,1643,1613,1597,1555,1429,1330,1261,1156,998,775,581,299,153];
s_2 = [101.56, 100.66, 100.35, 100.53, 93.16, 63.39, 60.55, 46.04, 44.04, 41.74, 39.85, 38.58, 35.27, 26.97, 22.56, 20.30, 16.77, 12.91, 8.68, 5.81, 2.60, 1.25];

% 40% AV
d_4 = [1,3,5,10,15,20,25,28,30,35,40,42,48,54,62,70,78,88,100,112,120];
q_4 = [103,256,501,992,1506,1936,1928,1901,1831,1787,1689,1661,1534,1444,1293,1221,1081,860,580,340,201];
s_4 = [102.24, 102.43, 100.10, 99.26, 100.34, 97.05, 80.06, 69.09, 60.66, 51.90, 42.81, 39.32, 32.47, 27.07,20.88, 17.81, 14.08, 9.91, 5.85, 3.04, 1.71];

% 60% AV 
d_6 = [3,5,10,20,28,30,34,38,38.1,41,43,46,57,59,60,67,74,85,97,109,113];
q_6 = [257,502,1002,1989,2087,2065,1932,1960,1794,1510,1631,1505,1363,1406,1464,1351,1194,909,682,394,334];
s_6 = [102.60, 100.38, 100.16, 99.72, 75.35, 69.13, 57.28, 51.81, 47.44, 36.92, 38.29, 32.53, 23.85, 23.89, 24.56, 20.34, 16.26, 10.80, 7.12, 3.63, 2.97];

% 80% AV
d_8 = [1,2,5,10,20,28,29.7,29.8,35,42,53,60,66,79,83,96,101,117,117];
q_8 = [105,258,515,1013,2012,2086,1850,2128,2160,1946,1625,1425,1363,1030,1052,765,549,230,267];
s_8 = [105.99, 104.97, 103.02, 101.29, 100.60, 75.89,  62.52, 71.65, 62.36, 46.74, 30.90, 23.97, 20.62, 13.11, 12.66, 8.00, 5.48, 1.99, 2.33];

%100% AV
d_10 = [1,3,5,10,20,30,40,49,59,67,77,88,97,107,116,124,127];
q_10 = [108,270,540,1080,2160,2460,2310,2077,1784,1591,1329,1089,857,649,402,184,89];
s_10 = [108.02, 108.02, 108.02, 108.02, 108.02, 83.49, 58.93, 42.90, 30.58, 23.74, 17.20, 12.39, 8.86, 6.11, 3.47, 1.49, 0.72];

%% q-k图
% lane1+lane2
subplot(2,1,1)
plot(d_0, q_0, '-or','MarkerSize',4,'MarkerFaceColor','r','LineWidth',1.4); hold on;  
plot(d_2, q_2, '-s','color',[.9, .6, 0.6],'MarkerSize',4,'MarkerFaceColor',[.9, .6, 0.6],'LineWidth',1.4); hold on;  
plot(d_4, q_4 ,'-*g','MarkerSize',4,'MarkerFaceColor','g','LineWidth',1.4); hold on;  
plot(d_6, q_6 ,'-db','MarkerSize',4,'MarkerFaceColor','b','LineWidth',1.4); hold on; 
plot(d_8, q_8 ,'-xm','MarkerSize',4,'MarkerFaceColor','m','LineWidth',1.4); hold on;  
plot(d_10, q_10 ,'-pk','MarkerSize',4,'MarkerFaceColor','k','LineWidth',1.4); hold on;  

xlabel('Density (veh/km)','FontSize',12)
ylabel('Flow (veh/h)','FontSize',12)  

set (gcf,'Position',[0,0,200,400])  %gcf:返回当前Figure对象的句柄值,设置图像大小和位置
                     %gcf,position后四个数：[pos(1) pos(2)]为绘图区域左下点的坐标 pos(3):长 pos(4):宽 
ylim([0 3000])
xlim([0,140])
legend('p_a_v=0','p_a_v=0.2','p_a_v=0.4','p_a_v=0.6','p_a_v=0.8','p_a_v=1.0');
%legend('p_a_v=0','p_a_v=1')
%% q-v图
subplot(2,1,2)
plot(d_0, s_0, '-or','MarkerSize',2,'MarkerFaceColor','r','LineWidth',1.1); hold on;  
 plot(d_2, s_2, '-sb','MarkerSize',5,'MarkerFaceColor','b','LineWidth',1.1); hold on;  
 plot(d_4, s_4 ,'->g','MarkerSize',5,'MarkerFaceColor','g','LineWidth',1.1); hold on;  
plot(d_6, s_6 ,'-dc','MarkerSize',5,'MarkerFaceColor','c','LineWidth',1.1); hold on; 
plot(d_8, s_8 ,'-<m','MarkerSize',5,'MarkerFaceColor','m','LineWidth',1.1); hold on;  
plot(d_10, s_10 ,'-pk','MarkerSize',5,'MarkerFaceColor','k','LineWidth',1.1); hold on;  

xlabel('Density (veh/km)','FontSize',12)
ylabel('Speed (km/h)','FontSize',12)  

set (gcf,'Position',[0,0,800,1000])  %gcf:返回当前Figure对象的句柄值,设置图像大小和位置
                     %gcf,position后四个数：[pos(1) pos(2)]为绘图区域左下点的坐标 pos(3):长 pos(4):宽 

xlim([0,140])
legend('p_a_v=0','p_a_v=0.2','p_a_v=0.4','p_a_v=0.6','p_a_v=0.8','p_a_v=1.0');
%legend('p_a_v=0','p_a_v=1')



